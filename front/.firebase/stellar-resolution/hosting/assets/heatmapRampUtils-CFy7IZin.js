const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BCRx-hwS.js","assets/index-BR8bGno3.css"])))=>i.map(i=>d[i]);
import{lA as I,qb as C,oV as $,eH as y,c3 as V,fk as E,_ as d,c7 as x,d9 as R,L as U,J as A,qc as N}from"./index-BCRx-hwS.js";import{N as M,$ as _}from"./utils-CtwuBDOf.js";function Y({level:t,class:e,...n},l){const o=w(t);return I(`h${o}`,{...n,"aria-level":String(o),class:C($.heading,e),role:"heading"},l)}function w(t){return y(Math.ceil(t),1,6)}function J(t,e=1){return w(t+e)}const O=/^-?(\d+)(\.(\d+))?$/i;function T(t,e){return t-e}function B(t,e){let n,l;return n=Number(t.toFixed(e)),n<t?l=n+1/10**e:(l=n,n-=1/10**e),n=Number(n.toFixed(e)),l=Number(l.toFixed(e)),[n,l]}function Q(t,e,n,l,o){const a=q(t,e,n,l),i=a.previous==null||a.previous<=o,r=a.next==null||a.next<=o;return i&&r||a.previous+a.next<=2*o}function v(t){const e=String(t),n=e.match(O);if(n!=null&&n[1])return{integer:n[1].split("").length,fractional:n[3]?n[3].split("").length:0};if(e.toLowerCase().includes("e")){const l=e.split("e"),o=l[0],a=l[1];if(o&&a){const i=Number(o);let r=Number(a);const u=r>0;u||(r=Math.abs(r));const s=v(i);return u?(s.integer+=r,r>s.fractional?s.fractional=0:s.fractional-=r):(s.fractional+=r,r>s.integer?s.integer=1:s.integer-=r),s}}return{integer:0,fractional:0}}function q(t,e,n,l){const o={previous:null,next:null};if(n!=null){const a=t-n,i=e-n-a;o.previous=Math.floor(Math.abs(100*i/a))}if(l!=null){const a=l-t,i=l-e-a;o.next=Math.floor(Math.abs(100*i/a))}return o}function tt(t,e={}){const n=t.slice(),{tolerance:l=2,strictBounds:o=!1,indexes:a=n.map((i,r)=>r)}=e;a.sort(T);for(let i=0;i<a.length;i++){const r=a[i],u=n[r],s=r===0?null:n[r-1],c=r===n.length-1?null:n[r+1],f=v(u).fractional;if(f){let p,m=0,g=!1;for(;m<=f&&!g;){const h=B(u,m);p=o&&i===0?h[1]:h[0],g=Q(u,p,s,c,l),m++}g&&(n[r]=p)}}return n}const F={maximumFractionDigits:20};function L(t){return V(t,F)}const k="<",G=">";function D(t,e,n,l){let o="";return e===0?o=`${k} `:e===n&&(o=`${G} `),o+(l?M(t,l):L(t))}const et=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function S(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find(i=>i.type==="color");if(!e)return null;let n=null,l=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;n=e.stops[0].value,l=e.stops[e.stops.length-1].value}const o=n!=null&&l!=null?n+(l-n)/2:0,{getColor:a}=await d(async()=>{const{getColor:i}=await import("./index-BCRx-hwS.js").then(r=>r.Gy);return{getColor:i}},__vite__mapDeps([0,1]));return a(e,o)??null}async function nt(t,e){const n=t.trailCap,l=t.trailWidth||1,o=e||await S(t)||t.color;return new E({cap:n,color:o,width:l})}function j(t,e){var n,l;if(!e.field)return null;if("featureReduction"in t)switch((n=t.featureReduction)==null?void 0:n.type){case"cluster":case"binning":{const o=t.featureReduction.fields.find(({name:a})=>a.toLowerCase()===e.field.toLowerCase());return o&&"getField"in t?t.getField(o.onStatisticField):null}}return"getField"in t?(l=t.getField)==null?void 0:l.call(t,e.field):null}function K(t,e){var l,o,a;const n="popupTemplate"in t?(l=t.popupTemplate)==null?void 0:l.fieldInfos:null;if(n!=null&&n.length&&e)return(a=(o=n.find(i=>{var r;return((r=i.fieldName)==null?void 0:r.toLowerCase())===e.toLowerCase()}))==null?void 0:o.format)==null?void 0:a.dateFormat}function lt(t,e,n){var a,i,r,u;const l=j(t,e);if(!l||!_(l)&&!x(l))return null;let o=K(t,l.name);if(!o&&l.type==="date"){let s=0,c=0;e.stops?(s=((i=(a=e.stops)==null?void 0:a.at(0))==null?void 0:i.value)??s,c=((u=(r=e.stops)==null?void 0:r.at(-1))==null?void 0:u.value)??c):"minDataValue"in e&&"maxDataValue"in e&&(s=e.minDataValue??s,c=e.maxDataValue??c),o=c-s>2*R.days?"short-date":"short-date-short-time"}return{fieldType:l.type,format:o,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:n,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}function ot(t,e){var n,l;if("authoringInfo"in t)return(l=(n=t.authoringInfo)==null?void 0:n.visualVariables)==null?void 0:l.find(({theme:o})=>o===e)}const W=new A([64,64,64]);function b(t,e){const n=[],l=t.length-1;return t.length===5?n.push(0,2,4):n.push(0,l),t.map((o,a)=>n.includes(a)?D(o,a,l,e):null)}async function at(t,e,n){let l=!1,o=[],a=[];if(t.stops){const s=t.stops;o=s.map(c=>c.value),l=s.some(c=>!!c.label),l&&(a=s.map(c=>c.label))}const i=o[0],r=o[o.length-1];if(i==null&&r==null)return null;const u=l?null:b(o,n);return(await Promise.all(o.map(async(s,c)=>{const f=t.type==="opacity"?await H(s,t,e):(await d(async()=>{const{getColor:m}=await import("./index-BCRx-hwS.js").then(g=>g.Gy);return{getColor:m}},__vite__mapDeps([0,1]))).getColor(t,s),p=l?a[c]:(u==null?void 0:u[c])??"";return f==null?null:{value:s,color:f,label:p}}))).filter(U).reverse()}async function H(t,e,n){const l=new A(n??W),o=(await d(async()=>{const{getOpacity:a}=await import("./index-BCRx-hwS.js").then(i=>i.Gy);return{getOpacity:a}},__vite__mapDeps([0,1]))).getOpacity(e,t);return o!=null&&(l.a=o),l}function rt(t){let e=!1,n=[],l=[];n=t.map(r=>r.value),e=t.some(r=>!!r.label),e&&(l=t.map(r=>r.label??""));const o=n[0],a=n[n.length-1];if(o==null&&a==null)return null;const i=e?null:b(n);return n.map((r,u)=>({value:r,color:P(r,t),label:e?l[u]:(i==null?void 0:i[u])??""})).reverse()}function P(t,e){const{startIndex:n,endIndex:l,weight:o}=Z(t,e);if(n===l)return e[n].color;const a=A.blendColors(e[n].color,e[l].color,o);return new A(a)}function Z(t,e){let n=0,l=e.length-1;return e.some((o,a)=>t<o.value?(l=a,!0):(n=a,!1)),{startIndex:n,endIndex:l,weight:(t-e[n].value)/(e[l].value-e[n].value)}}function it(t,e){let n=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((l,o)=>{o===0?n.push({value:e.max,color:new A(l.toColor),label:"high"}):n.push({value:null,color:new A(l.toColor),label:""}),o===t.colorRamps.length-1?n.push({value:e.min,color:new A(l.fromColor),label:"low"}):n.push({value:null,color:new A(l.fromColor),label:""})});else{let l,o;t&&t.type==="algorithmic"?(l=t.fromColor,o=t.toColor):(l=[0,0,0,1],o=[255,255,255,1]),n=[{value:e.max,color:new A(o),label:"high"},{value:e.min,color:new A(l),label:"low"}]}return n}function st(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter(l=>{var o;return((o=l.color)==null?void 0:o.a)>0});let n=e.length-1;if(e&&e[0]){const l=e[n];l&&l.ratio!==1&&(e.push(new N({ratio:1,color:l.color})),n++)}return e.map((l,o)=>{var i,r;let a="";return o===0?a=((i=t.legendOptions)==null?void 0:i.minLabel)||"low":o===n&&(a=((r=t.legendOptions)==null?void 0:r.maxLabel)||"high"),{color:l.color,label:a,ratio:l.ratio}}).reverse()}export{G as a,rt as b,ot as c,st as d,it as e,S as f,et as g,lt as h,v as i,Y as j,q as l,J as n,k as o,nt as p,D as r,P as s,at as t,tt as u};
