import{aA as D,aJ as E,aK as I,aL as R,az as c,aM as f,aN as w,aO as A,aP as g,aQ as F,aR as O,aS as T,aT as b,aU as m}from"./index-BCRx-hwS.js";function M(t,a,n=null){const e=[],s=a.mapPositions;d(a,e);const o=e[0][1].data,u=e[0][1].indices.length,r=E(u);return y(a,e,r),v(a,e,r),S(a,e,r),U(a,e,r),z(a,e,r),C(a,e,r),L(a,e,o),new I(t,e,s,R.Line,n)}function d(t,a){const{attributeData:{position:n},removeDuplicateStartEnd:e}=t,s=N(n)&&e,o=n.length/3-(s?1:0),u=new Array(2*(o-1)),r=s?n.slice(0,-3):n;let i=0;for(let h=0;h<o-1;h++)u[i++]=h,u[i++]=h+1;a.push([c.POSITION,new f(r,u,3,s)])}function y(t,a,n){if(t.attributeData.colorFeature!=null)return;const e=t.attributeData.color;a.push([c.COLOR,new f(e??w,n,4)])}function S(t,a,n){t.attributeData.normal&&a.push([c.NORMAL,new f(t.attributeData.normal,n,3)])}function U(t,a,n){t.attributeData.colorFeature!=null&&a.push([c.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],n,1,!0)])}function v(t,a,n){t.attributeData.sizeFeature==null&&a.push([c.SIZE,new f([t.attributeData.size??1],n,1,!0)])}function z(t,a,n){t.attributeData.sizeFeature!=null&&a.push([c.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],n,1,!0)])}function C(t,a,n){t.attributeData.opacityFeature!=null&&a.push([c.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],n,1,!0)])}function L(t,a,n){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==A.Global||!t.overlayInfo.spatialReference.isGeographic)return;const e=D(n.length),s=g(t.overlayInfo.spatialReference);for(let l=0;l<e.length;l+=3)F(n,l,e,l,s);const o=n.length/3,u=O(o+1);let r=P,i=B,h=0,p=0;T(r,e[p++],e[p++]),p++,u[0]=0;for(let l=1;l<o+1;++l)l===o&&(p=0),T(i,e[p++],e[p++]),p++,h+=m(r,i),u[l]=h,[r,i]=[i,r];a.push([c.DISTANCETOSTART,new f(u,a[0][1].indices,1,!0)])}function N(t){const a=t.length;return t[0]===t[a-3]&&t[1]===t[a-2]&&t[2]===t[a-1]}const P=b(),B=b();function $(t,a){if(t==null||t.length===0)return[];const n=[];return t.forEach(e=>{const s=e.length,o=D(3*s);e.forEach((r,i)=>{o[3*i]=r[0],o[3*i+1]=r[1],o[3*i+2]=r[2]});const u={attributeData:{position:o,normal:a},removeDuplicateStartEnd:!1};n.push(u)}),n}export{$ as R,M as b};
