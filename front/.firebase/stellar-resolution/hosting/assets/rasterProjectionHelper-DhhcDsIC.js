const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/projectOperator-BVWNqKaC.js","assets/index-BCRx-hwS.js","assets/index-BR8bGno3.css","assets/SimpleGeometryCursor-B92kdZ15.js","assets/geographicTransformationUtils-Cil6gQZm.js","assets/GeographicTransformation-IlwkDMhk.js"])))=>i.map(i=>d[i]);
import{P as Q,br as En,_ as sn,ak as W,L as kn,dp as C,al as G,d6 as Gn,s as mn,dq as T,dr as _,bI as Nn,ds as _n,dt as Tn,du as an,dv as vn}from"./index-BCRx-hwS.js";var Z;function z(){if(!nn)throw new mn("rasterprojectionhelper-project","projection operator is not loaded")}(function(n){n[n.None=0]="None",n[n.North=1]="North",n[n.South=2]="South",n[n.Both=3]="Both"})(Z||(Z={}));const ln=(n,e,o,r=0)=>{if(o[0]===1)return[0,0];let s=1,t=-1,i=1,c=-1;for(let u=0;u<n.length;u+=2)isNaN(n[u])||(s=s>n[u]?n[u]:s,t=t>n[u]?t:n[u],i=i>n[u+1]?n[u+1]:i,c=c>n[u+1]?c:n[u+1]);const{cols:a,rows:f}=e,l=(t-s)/a/o[0],d=(c-i)/f/o[1],h=2*r;let m=0,x=!1,g=[0,0];for(let u=0;u<a-3;u++){for(let R=0;R<f-3;R++){const y=u*f*2+2*R,p=(n[y]+n[y+4]+n[y+4*f]+n[y+4*f+4])/4,M=(n[y+1]+n[y+5]+n[y+4*f+1]+n[y+4*f+5])/4,w=Math.abs((p-n[y+2*f+2])/l),P=Math.abs((M-n[y+2*f+3])/d);if(w+P>m&&(m=w+P,g=[w,P]),h&&m>h){x=!0;break}}if(x)break}return g},Cn={3395:20037508342789244e-9,3410:17334193943686873e-9,3857:20037508342788905e-9,3975:17367530445161372e-9,4087:20037508342789244e-9,4088:20015108787169147e-9,6933:17367530445161372e-9,32662:20037508342789244e-9,53001:2001508679602057e-8,53002:1000754339801029e-8,53003:2001508679602057e-8,53004:2001508679602057e-8,53016:14152803599503474e-9,53017:17333573624304302e-9,53034:2001508679602057e-8,53079:20015114352186374e-9,53080:20015114352186374e-9,54001:20037508342789244e-9,54002:10018754171394624e-9,54003:20037508342789244e-9,54004:20037508342789244e-9,54016:14168658027268292e-9,54017:1736753044516137e-8,54034:20037508342789244e-9,54079:20037508342789244e-9,54080:20037508342789244e-9,54100:20037508342789244e-9,54101:20037508342789244e-9},q=32,B=4,D=B,K=new Map,V=new Map,Y=500,Ln=39.37,zn=96;let A,k,$,nn=!1;async function Dn(){return A||(A=En(),k=await sn(()=>import("./projectOperator-BVWNqKaC.js"),__vite__mapDeps([0,1,2,3])),$=await sn(()=>import("./geographicTransformationUtils-Cil6gQZm.js"),__vite__mapDeps([4,1,2,5])),k.isLoaded()||await k.load(),$.isLoaded()||await $.load(),nn=!0,A.resolve()),A.promise}function On(n,e,o){if(z(),o){const r=k.execute(n,e);return $.getTransformation(e,n.spatialReference,r)}return $.getTransformation(n.spatialReference,e,n)}function Kn(n,e,o,r){const s=n.spatialReference;if(!s||!e||s.equals(e))return n;z();const t=o.center,i=new W({xmin:t.x-n.x/2,xmax:t.x+n.x/2,ymin:t.y-n.y/2,ymax:t.y+n.y/2,spatialReference:s}),c=k.execute(i,e,{geographicTransformation:r}),a=v(e);return c==null||a!=null&&c.width>=a?j(n,s,e):{x:c.width,y:c.height}}function j(n,e,o){const r=C(e)/C(o);return{x:n.x*r,y:n.y*r}}function In(n,e,o){const{spatialReference:r}=o;if(!r||!e||r.equals(e))return n;if(r.isGeographic&&e.isGeographic)return j(n,r,e);if(z(),!nn)throw new mn("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let{x:s,y:t}=n;const i=(s+t)/2*C(r);let c=1;i>30&&(c=30/i,s*=c,t*=c);const a=256,f=s*a/2,l=t*a/2,{x:d,y:h}=o.center,m=[];for(let b=0;b<=a;b++)m.push([d-f,h-l+b*t]);for(let b=1;b<=a;b++)m.push([d-f+b*s,h+l]);for(let b=1;b<=a;b++)m.push([d+f,h+l-b*t]);for(let b=1;b<a;b++)m.push([d+f-b*s,h-l]);m.push(m[0]);const x=new Q({rings:[m],spatialReference:r}),g=k.execute(x,e);if(!g)return j(n,r,e);const u=g.extent,R=v(e);if(u==null||R!=null&&u.width>=R)return j(n,r,e);const y=Jn(g.rings),p=s*t*a*a,M=Math.sqrt(y/p)/c,w={x:u.width/c/a,y:u.height/c/a},P={x:s*M,y:t*M},N=w.x*w.y;return Math.abs(N-P.x*P.y)/N<.1?w:P}function $n(n,e){return(typeof n=="number"?n:(n.x+n.y)/2)*C(e)*zn*Ln}function Vn(n,e){const{pixelSize:o,extent:r}=n;return $n(In(o,e,r),e)}function E(n,e=.01){return C(n)?e/C(n):0}function cn(n,e,o,r=!0){const s=n.spatialReference;if(s.equals(e))return n;z();const t=k.execute(n,e,{geographicTransformation:o});return r&&t&&pn([n],[t],s,e),t}function pn(n,e,o,r){const s=F(o,!0),t=F(r,!0),i=E(o,Y),c=E(r,Y);if(i&&s!=null&&t!=null)for(let a=0;a<n.length;a++){const f=e[a];if(!f)continue;const{x:l}=n[a],{x:d}=f;d>=t[1]-c&&Math.abs(l-s[0])<i?f.x-=t[1]-t[0]:d<=t[0]+c&&Math.abs(l-s[1])<i&&(f.x+=t[1]-t[0])}}function Wn(n){const{inSR:e,outSR:o,preferPE:r}=n;if(e.equals(o)){const{points:s}=tn(n,null);return s}return e.isWebMercator&&o.isWGS84||e.isWGS84&&o.isWebMercator?jn(n):r&&(e.isGeographic||L(e)!=null)?fn(n):An(n)}function An(n){const{points:e}=tn(n,null),{inSR:o,outSR:r,datumTransformation:s}=n,t=e.map(c=>new G(c[0],c[1],o)),i=k.executeMany(t,r,{geographicTransformation:s});return s&&pn(t,i,o,r),i.map(c=>c?[c.x,c.y]:[NaN,NaN])}function fn(n){const{inSR:e,outSR:o,datumTransformation:r}=n,s=L(e),{points:t,mask:i}=tn(n,s);if(!e.isGeographic){const a=e.wkid?T.coordsys(e.wkid):T.fromString(e.isGeographic?_.PE_TYPE_GEOGCS:_.PE_TYPE_PROJCS,e.wkt2||e.wkt);an.projToGeog(a,t.length,t)}if(r!=null&&r.steps.length){let a;if(o.isGeographic&&(a=t.map(([l])=>l>179.9955?1:l<-179.9955?-1:0)),r.steps.forEach(l=>{const d=l.wkid?T.geogtran(l.wkid):T.fromString(_.PE_TYPE_GEOGTRAN,l.wkt);vn.geogToGeog(d,t.length,t,null,l.isInverse?_.PE_TRANSFORM_2_TO_1:_.PE_TRANSFORM_1_TO_2)}),a)for(let l=0;l<t.length;l++){const d=a[l],h=t[l][0],m=h>179.9955?1:h<-179.9955?-1:0;d&&m&&d!==m&&(t[l][0]=d>0?h+360:h-360)}}if(!o.isGeographic){const a=L(o,!0),f=a!=null&&a.isEnvelope?[a.bbox[1],a.bbox[3]]:[-90,90];qn(t,f);const l=o.wkid?T.coordsys(o.wkid):T.fromString(o.isGeographic?_.PE_TYPE_GEOGCS:_.PE_TYPE_PROJCS,o.wkt2||o.wkt);an.geogToProj(l,t.length,t)}let c=t;if(i&&t.length!==i.length){c=[];for(let a=0,f=0;a<i.length;a++)i[a]?c.push(t[f++]):c.push([NaN,NaN])}return c}function jn(n){const{cols:e,rows:o,xres:r,yres:s,usePixelCenter:t,inSR:i,outSR:c}=n;let{xmin:a,ymax:f}=n;t&&(a+=r/2,f-=s/2);const l=[],d=[],h=Math.max(e,o);for(let x=0;x<h;x++){const g=a+r*Math.min(e,x),u=f-s*Math.min(o,x),R=Tn(new G({x:g,y:u,spatialReference:i}),i,c);x<=e&&l.push(R.x),x<=o&&d.push(R.y)}const m=[];for(let x=0;x<e;x++)for(let g=0;g<o;g++)m.push([l[x],d[g]]);return m}function L(n,e=!1){let o=n.wkid||n.wkt2||n.wkt;if(!o||n.isGeographic)return null;if(o=String(o),K.has(o)){const i=K.get(o);return e?i==null?void 0:i.gcs:i==null?void 0:i.pcs}const r=n.wkid?T.coordsys(n.wkid):T.fromString(n.isGeographic?_.PE_TYPE_GEOGCS:_.PE_TYPE_PROJCS,n.wkt2||n.wkt),s=un(r,E(n,1e-4)),t=un(r,0,!0);return K.set(o,{pcs:s,gcs:t}),e?t:s}function un(n,e=0,o=!1){const r=_n.generate(n),s=o?n.horizonGcsGenerate():n.horizonPcsGenerate();if(!r||!(s!=null&&s.length))return null;let t=!1,i=s.find(u=>u.getInclusive()===1&&u.getKind()===1);if(!i){if(i=s.find(u=>u.getInclusive()===1&&u.getKind()===0),!i)return null;t=!0}const c=o?0:(r.getNorthPoleLocation()===2?1:0)|(r.getSouthPoleLocation()===2?2:0),a=r.isPannableRectangle(),f=i.getCoord();if(t)return{isEnvelope:t,isPannable:a,vertices:f,coef:null,bbox:[f[0][0]-e,f[0][1]-e,f[1][0]+e,f[1][1]+e],poleLocation:c};let l=0;const d=[];let[h,m]=f[0],[x,g]=f[0];for(let u=0,R=f.length;u<R;u++){l++,l===R&&(l=0);const[y,p]=f[u],[M,w]=f[l];if(w===p)d.push([y,M,p,w,2]);else{const P=(M-y)/(w-p||1e-4),N=y-P*p;p<w?d.push([P,N,p,w,0]):d.push([P,N,w,p,1])}h=h<y?h:y,m=m<p?m:p,x=x>y?x:y,g=g>p?g:p}return{isEnvelope:!1,isPannable:a,vertices:f,coef:d,bbox:[h,m,x,g],poleLocation:c}}function tn(n,e){const o=[],{cols:r,rows:s,xres:t,yres:i,usePixelCenter:c}=n;let{xmin:a,ymax:f}=n;if(c&&(a+=t/2,f-=i/2),e==null){for(let m=0;m<r;m++)for(let x=0;x<s;x++)o.push([a+t*m,f-i*x]);return{points:o}}const l=new Uint8Array(r*s);if(e.isEnvelope){const{bbox:[m,x,g,u]}=e;for(let R=0,y=0;R<r;R++){const p=a+t*R,M=e.isPannable||p>=m&&p<=g;for(let w=0;w<s;w++,y++){const P=f-i*w;M&&P>=x&&P<=u&&(o.push([p,P]),l[y]=1)}}return{points:o,mask:l}}const d=e.coef,h=[];for(let m=0;m<s;m++){const x=f-i*m,g=[],u=[];for(let y=0;y<d.length;y++){const[p,M,w,P,N]=d[y];if(x===w&&w===P)g.push(p),g.push(M),u.push(2),u.push(2);else if(x>=w&&x<=P){const b=p*x+M;g.push(b),u.push(N)}}let R=g;if(g.length>2){let y=u[0]===2?0:u[0],p=g[0];R=[];for(let M=1;M<u.length;M++)u[M]===2&&M!==u.length-1||(u[M]!==y&&(R.push(y===0?Math.min(p,g[M-1]):Math.max(p,g[M-1])),y=u[M],p=g[M]),M===u.length-1&&R.push(u[M]===0?Math.min(p,g[M]):Math.max(p,g[M])));R.sort((M,w)=>M-w)}else g[0]>g[1]&&(R=[g[1],g[0]]);h.push(R)}for(let m=0,x=0;m<r;m++){const g=a+t*m;for(let u=0;u<s;u++,x++){const R=f-i*u,y=h[u];if(y.length===2)g>=y[0]&&g<=y[1]&&(o.push([g,R]),l[x]=1);else if(y.length>2){let p=!1;for(let M=0;M<y.length;M+=2)if(g>=y[M]&&g<=y[M+1]){p=!0;break}p&&(o.push([g,R]),l[x]=1)}}}return{points:o,mask:l}}function qn(n,e){const[o,r]=e;for(let s=0;s<n.length;s++){const t=n[s][1];(t<o||t>r)&&(n[s]=[NaN,NaN])}}function gn(n,e){const o=v(n[0].spatialReference);if(n.length<2||o==null||(e=e??E(n[0].spatialReference),(n=n.filter(c=>c.width>e)).length===1))return n[0];let{xmin:r,xmax:s,ymin:t,ymax:i}=n[0];for(let c=1;c<n.length;c++){const a=n[c];s=a.xmax+o*c,t=Math.min(t,a.ymin),i=Math.max(i,a.ymax)}return new W({xmin:r,xmax:s,ymin:t,ymax:i,spatialReference:n[0].spatialReference})}function yn(n,e,o=null,r=!0){const s=n.spatialReference;if(s.equals(e)||!e)return n;const t=dn(n),i=v(s,!0),c=v(e);if(t===0||i==null||c==null){const l=H(n,e,o,r);if(l&&i==null&&c!=null&&Math.abs(l.width-c)<E(e)&&k.isLoaded()){const d=L(s);if(d!=null&&d.poleLocation===Z.None&&n.width<(d.bbox[2]-d.bbox[0])/2)return Bn(n,e)||l}return l}const a=n.clone().normalize();if(a.length===1&&n.xmax<i&&n.xmax-i/2>E(s)){const{xmin:l,xmax:d}=n;for(let h=0;h<=t;h++){const m=h===0?l:-i/2,x=h===t?d-i*h:i/2;a[h]=new W({xmin:m,xmax:x,ymin:n.ymin,ymax:n.ymax,spatialReference:s})}}const f=a.map(l=>H(l,e,o,r)).filter(kn);return f.length===0?null:gn(f)}function Un(n,e,o){if(n.type==="extent"){const{xmin:r,ymin:s,xmax:t,ymax:i,spatialReference:c}=n;n=new Q({rings:[[[r,i],[t,i],[t,s],[r,s],[r,i]]],spatialReference:c})}return n.spatialReference.equals(e)?n:(z(),k.execute(n,e,{geographicTransformation:o}))}function Bn(n,e){const o=v(e);if(o==null)return null;let{xmin:r,ymin:s,xmax:t,ymax:i}=n;const c=n.spatialReference,a=new Q({spatialReference:c,rings:[[[r,s],[t,s],[t,i],[r,i],[r,s]]]}),f=k.execute(a,e);if(f.rings.length!==2||!f.rings[0].length||!f.rings[1].length)return null;const{rings:l}=f,d=E(c),h=new W({spatialReference:e});for(let m=0;m<2;m++){r=t=l[m][0][0],s=i=l[m][0][1];for(let x=0;x<l[m].length;x++)r=r>l[m][x][0]?l[m][x][0]:r,t=t<l[m][x][0]?l[m][x][0]:t,s=s>l[m][x][1]?l[m][x][1]:s,i=i<l[m][x][1]?l[m][x][1]:i;if(m===0)h.ymin=s,h.ymax=i,h.xmin=r,h.xmax=t;else if(h.ymin=Math.min(h.ymin,s),h.ymax=Math.max(h.ymax,i),Math.abs(t-o/2)<d)h.xmin=r,h.xmax=h.xmax+o;else{if(!(Math.abs(r+o/2)<d))return null;h.xmax=t+o}}return h}function H(n,e,o,r=!0,s=!0){const t=n.spatialReference;if(t.equals(e)||!e)return n;z();const i=k.execute(n,e,{geographicTransformation:o});if(s&&e.isWebMercator&&i&&(i.ymax=Math.min(20037508342787e-6,i.ymax),i.ymin=Math.max(-20037508342787e-6,i.ymin),i.ymin>=i.ymax))return null;if(!r||!i)return i;const c=F(t,!0),a=F(e,!0);if(c==null||a==null)return i;const f=E(t,.001),l=E(t,Y),d=E(e,.001);if(Math.abs(i.xmin-a[0])<d&&Math.abs(i.xmax-a[1])<d){const h=Math.abs(n.xmin-c[0]),m=Math.abs(c[1]-n.xmax);if(h<f&&m>l){i.xmin=a[0];const x=[];x.push(new G(n.xmax,n.ymin,t)),x.push(new G(n.xmax,(n.ymin+n.ymax)/2,t)),x.push(new G(n.xmax,n.ymax,t));const g=x.map(u=>cn(u,e,o)).filter(u=>!isNaN(u==null?void 0:u.x)).map(u=>u.x);i.xmax=Math.max.apply(null,g)}if(m<f&&h>l){i.xmax=a[1];const x=[];x.push(new G(n.xmin,n.ymin,t)),x.push(new G(n.xmin,(n.ymin+n.ymax)/2,t)),x.push(new G(n.xmin,n.ymax,t));const g=x.map(u=>cn(u,e,o)).filter(u=>!isNaN(u==null?void 0:u.x)).map(u=>u.x);i.xmin=Math.min.apply(null,g)}}else{const h=E(e,.001);Math.abs(i.xmin-a[0])<h&&(i.xmin=a[0]),Math.abs(i.xmax-a[1])<h&&(i.xmax=a[1])}return i}function v(n,e=!1){if(!n)return null;const o=e?20037508342787e-6:20037508342788905e-9;return n.isWebMercator?2*o:n.wkid&&n.isGeographic?360:2*Cn[n.wkid]||null}function F(n,e=!1){if(n.isGeographic)return[-180,180];const o=v(n,e);return o!=null?[-o/2,o/2]:null}function xn(n,e,o,r){let s=(n-e)/o;return s-Math.floor(s)!==0?s=Math.floor(s):r&&(s-=1),s}function dn(n,e=!1){const o=v(n.spatialReference);if(o==null)return 0;const r=e?0:-(o/2),s=E(n.spatialReference),t=!e&&Math.abs(n.xmax-o/2)<s?o/2:n.xmax,i=!e&&Math.abs(n.xmin+o/2)<s?-o/2:n.xmin;return xn(t,r,o,!0)-xn(i,r,o,!1)}function Zn(n){const e=n.storageInfo.origin.x,o=v(n.spatialReference,!0);if(o==null)return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const r=o/2,{nativePixelSize:s,storageInfo:t,extent:i}=n,{maximumPyramidLevel:c,blockWidth:a,pyramidScalingFactor:f}=t;let l=s.x;const d=[],h=n.transform!=null&&n.transform.type==="gcs-shift",m=e+(h?0:r),x=h?o-e:r-e;for(let g=0;g<=c;g++){const u=(i.xmax-e)/l/a,R=u-Math.floor(u)===0?u:Math.ceil(u),y=x/l/a,p=y-Math.floor(y)===0?y:Math.ceil(y),M=Math.floor(m/l/a),w=Math.round(m/l)%a,P=(a-Math.round(x/l)%a)%a;d.push({resolutionX:l,blockWidth:a,datasetColumnCount:R,worldColumnCountFromOrigin:p,leftMargin:w,rightPadding:P,originColumnOffset:M}),l*=f}return{originX:e,halfWorldWidth:r,pyramidsInfo:d,hasGCSSShiftTransform:h}}function Yn(n){if(!n||n.isGeographic)return n;const e=String(n.wkid||n.wkt2||n.wkt);let o;return V.has(e)?o=V.get(e):(o=(n.wkid?T.coordsys(n.wkid):T.fromString(_.PE_TYPE_PROJCS,n.wkt2||n.wkt)).getGeogcs().getCode(),V.set(e,o)),new Nn({wkid:o})}function Hn(n){const e=n.isAdaptive&&n.spacing==null;let o=n.spacing||[q,q],r=U(n),s={cols:r.size[0]+1,rows:r.size[1]+1};const t=r.outofBoundPointCount>0&&r.outofBoundPointCount<r.offsets.length/2;let i=r.outofBoundPointCount===r.offsets.length/2||e&&t?[0,0]:ln(r.offsets,s,o,D);const c=(i[0]+i[1])/2,a=n.projectedExtent.spatialReference,f=n.srcBufferExtent.spatialReference;if(e&&(t||c>D)&&(a.isGeographic||L(a),o=[B,B],r=U({...n,spacing:o}),s={cols:r.size[0]+1,rows:r.size[1]+1},i=ln(r.offsets,s,o,D)),r.error=i,o[0]>1&&(r.coefficients=hn(r.offsets,s,t)),n.includeGCSGrid&&!a.isGeographic&&!a.isWebMercator)if(f.isGeographic)r.gcsGrid={offsets:r.offsets,coefficients:r.coefficients,spacing:o};else{const l=L(a);if(l!=null&&!l.isEnvelope){const d=Yn(a),h=yn(n.projectedExtent,d),{offsets:m}=U({...n,srcBufferExtent:h,spacing:o}),x=hn(m,s,t);r.gcsGrid={offsets:m,coefficients:x,spacing:o}}}return r}function U(n){const{projectedExtent:e,srcBufferExtent:o,pixelSize:r,datumTransformation:s,rasterTransform:t}=n,i=e.spatialReference,c=o.spatialReference;z();const{xmin:a,ymin:f,xmax:l,ymax:d}=e,h=v(c),m=h!=null&&(n.hasWrapAround||(t==null?void 0:t.type)==="gcs-shift"),x=n.spacing||[q,q],g=x[0]*r.x,u=x[1]*r.y,R=x[0]===1,y=Math.ceil((l-a)/g-.1/x[0])+(R?0:1),p=Math.ceil((d-f)/u-.1/x[1])+(R?0:1),M=Wn({cols:y,rows:p,xmin:a,ymax:d,xres:g,yres:u,inSR:i,outSR:c,datumTransformation:s,preferPE:x[0]<=B,usePixelCenter:R}),w=[];let P,N=0;const b=R?-1:NaN,{xmin:en,xmax:J,ymax:wn,width:Mn,height:Rn}=o,Pn=E(c,Y),bn=h!=null&&en>0&&J>h/2,on=L(i),Sn=on!=null&&on.poleLocation>0;for(let O=0;O<y;O++){const X=[];for(let I=0;I<p;I++){let S=M[O*p+I];if(m&&S[0]>J&&S[0]>h/2-Pn?S[0]-=h:m&&O===0&&S[0]<0&&bn&&!t&&(S[0]+=h),!S||isNaN(S[0])||isNaN(S[1]))w.push(b),w.push(b),X.push(null),N++;else{if(t){const rn=t.inverseTransform(new G({x:S[0],y:S[1],spatialReference:c}));S=[rn.x,rn.y]}X.push(S),O>0&&m&&P[I]&&S[0]<P[I][0]&&(S[0]+=h,Sn&&S[0]>J&&S[0]>h&&(S[0]-=h)),w.push((S[0]-en)/Mn),w.push((wn-S[1])/Rn)}}P=X}return{offsets:w,error:null,coefficients:null,outofBoundPointCount:N,spacing:x,size:R?[y,p]:[y-1,p-1]}}function hn(n,e,o){const{cols:r,rows:s}=e,t=new Float32Array((r-1)*(s-1)*2*6),i=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),c=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let a=0;a<r-1;a++){for(let f=0;f<s-1;f++){let l=a*s*2+2*f;const d=n[l],h=n[l+1],m=n[l+2],x=n[l+3];l+=2*s;const g=n[l],u=n[l+1],R=n[l+2],y=n[l+3];let p=0,M=12*(f*(r-1)+a);for(let w=0;w<3;w++)t[M++]=i[p++]*d+i[p++]*m+i[p++]*R;p=0;for(let w=0;w<3;w++)t[M++]=i[p++]*h+i[p++]*x+i[p++]*y;p=0;for(let w=0;w<3;w++)t[M++]=c[p++]*d+c[p++]*g+c[p++]*R;p=0;for(let w=0;w<3;w++)t[M++]=c[p++]*h+c[p++]*u+c[p++]*y}if(o)for(let f=0;f<t.length;f++)isNaN(t[f])&&(t[f]=-1)}return t}function Fn(n,e){const o=n.clone().normalize();return o.length===1?o[0]:gn(o,e)}function Qn(n){const{spatialReference:e}=n,o=Gn(e);if(!o)return n;const[r,s]=o.valid,t=s-r;let i=0;if(n.xmin<r){const c=r-n.xmin;i=Math.ceil(c/t)}else if(n.xmin>s){const c=n.xmin-s;i=-Math.ceil(c/t)}return new W({spatialReference:n.spatialReference,xmin:n.xmin+i*t,ymin:n.ymin,xmax:n.xmax+i*t,ymax:n.ymax})}function nt(n,e,o){var x;const{storageInfo:r,pixelSize:s}=e;let t=0,i=!1;const{pyramidResolutions:c}=r,a=((x=r.tileInfo.format)==null?void 0:x.toLowerCase())==="mixed"?Math.max(1,Math.min(3,r.tileInfo.dpi/96)):1,f=(n.x+n.y)/2/a;if(c!=null&&c.length){const g=c[c.length-1],u=(g.x+g.y)/2,R=(s.x+s.y)/2;if(f<=R)t=0;else if(f>=u)t=c.length,i=f/u>8;else{let p,M=R;for(let w=1;w<=c.length;w++){if(p=(c[w-1].x+c[w-1].y)/2,f<=p){f===p?t=w:o==="down"?(t=w-1,i=f/M>8):t=o==="up"||f-M>p-f||f/M>2?w:w-1;break}M=p}}const y=t===0?s:c[t-1];return i&&Math.min(y.x,y.y)*C(e.spatialReference)>19567&&(i=!1),{pyramidLevel:t,pyramidResolution:new G({x:y.x,y:y.y,spatialReference:e.spatialReference}),excessiveReading:i}}const l=Math.log(n.x/s.x)/Math.LN2,d=Math.log(n.y/s.y)/Math.LN2,h=e.storageInfo.maximumPyramidLevel||0;t=o==="down"?Math.floor(Math.min(l,d)):o==="up"?Math.ceil(Math.max(l,d)):Math.round((l+d)/2),t<0?t=0:t>h&&(i=t>h+3,t=h);const m=2**t;return{pyramidLevel:t,pyramidResolution:new G({x:m*e.nativePixelSize.x,y:m*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:i}}function tt(n,e,o=!1){const{pixelSize:r,extent:s}=n,t=On(s,e,!1),i=yn(Fn(s,(r.x+r.y)/16),e,t);return!i||o||dn(i)===0?i:H(s,e,t)}function Jn(n){let e=0;for(const o of n){const r=o.length;let s=o[0][0]*(o[1][1]-o[r-2][1]);for(let t=1;t<r-1;t++)s+=o[t][0]*(o[t+1][1]-o[t-1][1]);e+=s/2}return Math.abs(e)}export{cn as A,On as C,Vn as O,yn as Q,Un as V,Kn as _,v as e,Qn as f,Zn as i,tt as m,dn as o,Hn as s,nt as u,Dn as v};
