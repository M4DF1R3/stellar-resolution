import{c as q,a as w}from"./devEnvironmentUtils-CnNDiFMM.js";import{a_ as U,b0 as c,s as b,hw as S,jm as D,jn as O,jo as _,jp as $,jg as x,jq as j,jr as N,js as z,jt as A,ju as C}from"./index-BCRx-hwS.js";const R=["web-gltf","web","cim"];function W(t,e,l){const a=t.name;return a==null?Promise.reject(new b("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?k(a,e,l):z(t,e,l).then(n=>P(n,a,e,A,l))}function v(t,e){return e.items.find(l=>l.name===t)}async function P(t,e,l,a,n){var g,h;const s=(l==null?void 0:l.portal)!=null?l.portal:U.getDefault(),r={portal:s,url:c(t.baseUrl)},m=v(e,t.data);if(!m)throw new b("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});const u=(n==null?void 0:n.acceptedFormats)??R,p=a(m,u);if(!p)throw new b("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${u})`,{symbolName:e});const{url:T,format:F}=p;let i=S(T,r),y=((g=m.thumbnail)==null?void 0:g.href)??null;const f=(h=m.thumbnail)==null?void 0:h.imageData;q()&&(i=w(i)??"",y=w(y));const E={portal:s,url:c(D(i)),origin:"portal-item"};return O(i,n).then(d=>{const I=F==="cim"?_(d.data):d.data,o=$(I,E);if(o&&x(o)){if(y){const M=S(y,r);o.thumbnail=new j({url:M})}else f&&(o.thumbnail=new j({url:`data:image/png;base64,${f}`}));t.styleUrl?o.styleOrigin=new N({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(o.styleOrigin=new N({portal:l.portal,styleName:t.styleName,name:e}))}return o})}function k(t,e,l){const a=C.replaceAll(/\{SymbolName\}/gi,t),n=e.portal!=null?e.portal:U.getDefault();return O(a,l).then(s=>{const r=_(s.data);return $(r,{portal:n,url:c(D(a)),origin:"portal-item"})})}const H=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:P,getStyleItemFromStyle:v,resolveWebStyleSymbol:W},Symbol.toStringTag,{value:"Module"}));export{R as e,v as g,W as h,P as j,H as w};
